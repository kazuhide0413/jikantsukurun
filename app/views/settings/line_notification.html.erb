<div class="bg-[#e8e7e7] min-h-screen flex flex-col items-center justify-start p-6">
  <div class="container mx-auto pt-3">
    <div class="flex justify-center">
      <div class="w-full max-w-sm flex flex-col items-center text-center space-y-8">

        <!-- タイトル -->
        <section aria-labelledby="line-notification-title">
          <h1 id="line-notification-title"
              class="text-2xl text-black [font-family:'Rounded_Mplus_1c-Regular',Helvetica]">
            有効に使えた時間を<br>
            毎朝8時にLINEで通知します
          </h1>
        </section>

        <!-- LINE連携ボタン（状態で切り替え） -->
        <section class="w-full">
          <% if @user.line_user_id.present? %>
            <!-- 連携済み -->
            <button
              type="button"
              disabled
              class="block w-full bg-white border border-gray-300 rounded-xl py-3
                     text-2xl font-medium text-black
                     cursor-default shadow-sm text-center
                     [font-family:'Rounded_Mplus_1c-Regular',Helvetica]">
              LINE連携済み
            </button>
          <% else %>
            <!-- 未連携：押すとコード発行→LINEに移動（入力済み） -->
            <%= button_to generate_line_link_token_settings_path,
                method: :patch,
                data: { turbo: false },
                class: "w-full flex items-center justify-center gap-4
                        bg-[#06C755] hover:bg-[#05B44B]
                        rounded-xl py-3
                        text-2xl font-medium text-white
                        transition-colors
                        shadow-sm
                        [font-family:'Rounded_Mplus_1c-Medium',Helvetica]" do %>

              <%= image_tag "line.png",
                  alt: "LINE",
                  class: "w-7 h-7 bg-white rounded p-1" %>

              <span>LINE連携をする</span>
            <% end %>

            <p class="mt-3 text-sm text-gray-600 [font-family:'Rounded_Mplus_1c-Regular',Helvetica]">
              ※ ボタンを押すとLINEが開き、コードが入力された状態になります。送信してください。
            </p>
          <% end %>
        </section>

        <!-- 通知ON -->
        <section class="w-full">
          <%= button_to "通知ON",
              enable_line_notification_settings_path,
              method: :patch,
              disabled: !@user.line_user_id.present?,
              class: "block w-full bg-[#67c2fa] hover:bg-[#4eb3f7] rounded-xl py-3
                      text-2xl font-medium text-black
                      transition-colors shadow-sm text-center
                      [font-family:'Rounded_Mplus_1c-Medium',Helvetica]
                      #{'opacity-50 cursor-not-allowed hover:bg-[#67c2fa]' unless @user.line_user_id.present?}" %>
        </section>

        <!-- 通知OFF -->
        <section class="w-full">
          <%= button_to "通知OFF",
              disable_line_notification_settings_path,
              method: :patch,
              disabled: !@user.line_user_id.present?,
              class: "block w-full bg-[#ff0000] hover:bg-[#e60000] rounded-xl py-3
                      text-2xl font-medium text-black
                      transition-colors shadow-sm text-center
                      [font-family:'Rounded_Mplus_1c-Medium',Helvetica]
                      #{'opacity-50 cursor-not-allowed hover:bg-[#ff0000]' unless @user.line_user_id.present?}" %>
        </section>

        <!-- 戻るボタン -->
        <section class="w-full">
          <%= link_to "戻る", settings_path,
              class: "block w-full bg-white border border-gray-300 rounded-xl py-3
                      text-2xl text-black font-medium
                      hover:bg-gray-100 transition-colors shadow-sm text-center
                      [font-family:'Rounded_Mplus_1c-Regular',Helvetica]" %>
        </section>

      </div>
    </div>
  </div>
</div>
